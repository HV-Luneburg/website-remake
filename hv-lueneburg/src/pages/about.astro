---
import Hero from '~/components/widgets/Hero.astro';
import Stats from '~/components/widgets/Stats.astro';
import Steps2 from '~/components/widgets/Steps2.astro';
import Layout from '~/layouts/PageLayout.astro';
import { sanityClient } from 'sanity:client';

const sanityAboutPage = await sanityClient.fetch(`*[_type == "aboutPage"][0]{
  ...,
  "heroImage": hero.image.asset->url
}`);

const about = sanityAboutPage || {};

const heroData = about.hero || {
  tagline: 'Über uns',
  title: 'Über den <span class="text-accent dark:text-white">HV Lüneburg</span>',
  subtitle: 'Der Handballverein Lüneburg steht für Handball mit Leidenschaft. Seit unserer Gründung fördern wir den Handballsport in Lüneburg und Umgebung — vom Nachwuchs bis zu den Senioren.'
};

const statsData = about.statsText || {
  title: 'Unser Verein in Zahlen',
  stats: [
    { title: 'Gründungsjahr', amount: '1946' },
    { title: 'Teams', amount: '17' },
    { title: 'Mitglieder', amount: '250+' },
  ]
};

const valuesData = about.valuesSection || {
  title: 'Unsere Werte',
  subtitle: 'Was uns als Verein antreibt und zusammenhält.',
  items: [
    {
      title: 'Teamgeist',
      description: 'Gemeinsam sind wir stark — auf und neben dem Spielfeld. Bei uns zählt das Miteinander.',
    },
    {
      title: 'Fairplay',
      description: 'Respekt gegenüber Mitspielern, Gegnern und Schiedsrichtern ist für uns selbstverständlich.',
    },
    {
      title: 'Jugendförderung',
      description: 'Wir investieren in die Zukunft des Handballs und bieten jungen Spielerinnen und Spielern die beste Ausbildung.',
    },
  ]
};

const heroImageUrl = about.heroImage || 'https://images.unsplash.com/photo-1559136555-9303baea8ebd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80';

const metadata = {
  title: 'Über uns | HV Lüneburg',
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero
    tagline={heroData.tagline}
    image={{
      src: heroImageUrl,
      alt: 'HV Lüneburg',
    }}
  >
    <Fragment slot="title" set:html={heroData.title}></Fragment>
    <Fragment slot="subtitle" set:html={heroData.subtitle}></Fragment>
  </Hero>

  <!-- Stats Widget ****************** -->

  <Stats
    title={statsData.title}
    stats={statsData.stats.map(s => ({ title: s.title, amount: s.amount }))}
  />

  <!-- Steps2 Widget ****************** -->

  <Steps2
    title={valuesData.title}
    subtitle={valuesData.subtitle}
    items={valuesData.items.map(i => ({ title: i.title, description: i.description }))}
  />
</Layout>
